<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <title>考勤系统</title>
    <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.9.0/fullcalendar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.9.0/locale/zh-cn.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.9.0/fullcalendar.min.css"  rel='stylesheet' >
    <link href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.9.0/fullcalendar.print.css" rel='stylesheet' media='print'>

    <link href="{% static "/js/layui/css/layui.css" %}" rel='stylesheet' media='print'>
    <script src="{% static "/js/layui/layui.all.js" %}"></script>
    <style>

        body {
            margin: 40px 10px;
            padding: 0;
            font-family: "Lucida Grande",Helvetica,Arial,Verdana,sans-serif;
            font-size: 14px;
        }

        #calendar {
            max-width: 900px;
            margin: 0 auto;
        }

    </style>
</head>
<body>
    这是一个考勤系统
    <div id='calendar'></div>

    <script type="text/javascript">
        $(document).ready(function() {

            var calendar = $('#calendar').fullCalendar({
                editable: true,
                eventLimit: true,
                dayClick: function(date, jsEvent, view){
                    var param = {"date": date.format("YYYY-MM-dd")}
                    window.open("")
                },
                dayRender: function(date, cell){

                },
                eventAfterRender: function(event, element, view){

                },
                eventMouseover: function(event, jsEvent, view){
                    this.title = event.tooltip
                },
                viewRender: function( view, element ){
                    var month = view.intervalStart.format("YYYY-MM");
                    $.getJSON("/ajax_demo", {"month":month}, function(reponse){
                        if(reponse.status==200){
                            var events = reponse.content.data;
                            var clientEvents = calendar.fullCalendar("clientEvents", function(event){
                                return event.start.format("YYYY-MM") == month
                            })

                            if( clientEvents.length>0 ){
                                calendar.fullCalendar("updateEvents", events)
                            }else{
                                calendar.fullCalendar("addEventSource", events)
                            }
                        }
                    })
                }
            });

        });
    </script>
</body>
</html>